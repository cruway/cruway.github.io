結合インデックスを構成するカラムの順番
インデックスを利用して性能向上の効果を期待したいならまず、該当のインデックスを利用し処理範囲を最大限に減少しな
ければならない。性能を向上するためには結合インデックスを構成するカラムは必ず次の順番に合うように生成する必要がある。

・1番：カラムを使用する演算子によるインデックス選定
・2番：ランダムアクセスを考慮したインデックスカラム選定
・3番：整列除去するためのインデックスカラム選定
・4番：単一カラムの分布図を考慮したインデックスカラム選定

この4段階優先順位によって我々は結合インデックスを生成する。この優先順位を守らないとそもそも該当インデックスを
利用した性能向上は難しくなる。

もちろん、結合インデックスを生成する優先順位でWHERE条件で使うカラムをインデックス構成することは当然のことで除外
した。該当SQLで使わないカラムを特別な理由なしでインデックスに追加するのはあまり多くない。

こんな結合インデックス構成ルールはなぜ作られたのか？少し考えるとこの回答はすぐ出るはずだ。ディスクのI/Oを減少
するためだ。

結局、こんな優先順位でインデックスを生成すると我々が望むデータを抽出するときに、最小限のディスクI/Oを発生して
性能を保証することができる。


結合インデックスを構成するカラム演算子に注目

インデックスを生成する場合、該当のカラム分布図を考慮する場合が多い。これは間違えた知識から始まったエラーである。
次の例を通じてインデックスを生成すると仮定しよう
SELECT カード番号、使用額
FROM 取引内訳
WHERE カード番号 = '111'
AND 取引日付 BETWEEN '20080501'
             AND '20080510';
例みたいにSQLを実行する場合はどうですか？カード番号カラムの分布図はとても良いで取引日付カラム分布図はとても悪いと
仮定しよう。

分布図が良いという意味は該当のテーブルでカード番号の値が'111'を満足するデータがとても少ないという意味だ。分布図
が悪いという意味はこれとは違う反対の意味を持つ。

従って、分布図が良いカラムであるカード番号カラムをインデックスの一番前に置いといて分布図が悪い取引日付カラムを
後ろに構成すると仮定しよう

そうしたらインデックスはカード番号+取引日付インデックスになり、これはカラム分布図を考慮してインデックスを生成する場合だ。

こうしてにインデックスを構成したらカード番号カラムの値によって処理範囲が減少できて取引日付カラムによっても処理範囲が
減少できて臨むデータに関して最小のアクセスで結果を抽出することができる。

この例を通じて分布図が良いカラムを前にしてインデックスを構成することができるんでしょ？という話をすることができるが。

次の例を確認しよう。

SELECT カード番号、使用額
FROM 取引内訳
WHERE カード番号 BETWEEN '111'
                 AND '555'
AND 取引日付 = '20080515'

